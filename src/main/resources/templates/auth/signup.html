<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/base :: layout(title='Board Hole 회원가입', content=~{::section})}">
<head>
    <title>Board Hole 회원가입</title>
</head>
<body>

<section>
    <article>
        <header>
            <hgroup>
                <h1>회원가입</h1>
                <p>Board Hole 계정을 만들고 커뮤니티에 참여하세요.</p>
            </hgroup>
        </header>

        <main>
            <form th:action="@{/auth/signup}" th:object="${userCreateRequest}" method="post">
                <fieldset>
                    <label for="email">
                        이메일
                        <input id="email" type="email" placeholder="you@example.com" 
                               th:field="*{email}" autocomplete="email" required
                               th:attr="aria-invalid=${#fields.hasErrors('email')} ? 'true' : (${#fields.hasAnyErrors()} ? 'false' : null),aria-describedby=${#fields.hasErrors('email')} ? 'email-help' : null">
                        <small>로그인 확인 및 알림에 사용됩니다.</small>
                    </label>
                    <small id="email-help" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">
                        이메일 오류
                    </small>

                    <label for="name">
                        이름
                        <input id="name" type="text" placeholder="홍길동" maxlength="50"
                               th:field="*{name}" autocomplete="name" required
                               th:attr="aria-invalid=${#fields.hasErrors('name')} ? 'true' : (${#fields.hasAnyErrors()} ? 'false' : null),aria-describedby=${#fields.hasErrors('name')} ? 'name-help' : null">
                    </label>
                    <small id="name-help" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">
                        이름 오류
                    </small>

                    <label for="username">
                        사용자명
                        <input id="username" type="text" placeholder="영문과 숫자 조합으로 3-20자" 
                               minlength="3" maxlength="20" pattern="^[a-zA-Z0-9]{3,20}$"
                               title="영문과 숫자만 사용하여 3-20자로 입력해주세요."
                               th:field="*{username}" autocomplete="username" required
                               th:attr="aria-invalid=${#fields.hasErrors('username')} ? 'true' : (${#fields.hasAnyErrors()} ? 'false' : null),aria-describedby=${#fields.hasErrors('username')} ? 'username-help' : null">
                        <small>영문, 숫자 조합으로 3-20자 이내로 입력해주세요.</small>
                    </label>
                    <small id="username-help" th:if="${#fields.hasErrors('username')}" th:errors="*{username}">
                        사용자명 오류
                    </small>

                    <label for="password">
                        비밀번호
                        <input id="password" type="password" placeholder="보안이 강한 비밀번호" 
                               minlength="8" maxlength="100" th:field="*{password}" autocomplete="new-password" required
                               pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[@$!%*?&])[A-Za-z0-9@$!%*?&]{8,100}$"
                               title="8자 이상, 대/소문자, 숫자, 특수문자를 모두 포함해야 합니다."
                               th:attr="aria-invalid=${#fields.hasErrors('password')} ? 'true' : (${#fields.hasAnyErrors()} ? 'false' : null),aria-describedby=${#fields.hasErrors('password')} ? 'password-help' : null">
                        <small>8자 이상이며 대/소문자 · 숫자 · 특수문자를 각각 포함해야 합니다.</small>
                    </label>
                    <small id="password-help" th:if="${#fields.hasErrors('password')}" th:errors="*{password}">
                        비밀번호 오류
                    </small>

                    <label for="confirmPassword">
                        비밀번호 확인
                        <input id="confirmPassword" type="password" placeholder="비밀번호를 다시 입력"
                               th:field="*{confirmPassword}" autocomplete="new-password" required
                               th:attr="aria-invalid=${#fields.hasErrors('confirmPassword')} ? 'true' : (${#fields.hasAnyErrors()} ? 'false' : null),aria-describedby=${#fields.hasErrors('confirmPassword')} ? 'confirm-password-help' : null">
                    </label>
                    <small id="confirm-password-help" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}">
                        비밀번호 확인 오류
                    </small>

                    <label>
                        <input type="checkbox" name="agree" required>
                        이용약관과 개인정보 처리방침에 동의합니다.
                    </label>
                </fieldset>

                <input type="submit" value="회원가입" class="primary">
            </form>

            <p>
                <small>이미 계정이 있으신가요? <a th:href="@{/auth/login}">로그인</a></small>
            </p>
        </main>

        <footer th:if="${error} or ${globalError}">
            <del th:if="${error}" th:text="${error}">입력값을 다시 확인해 주세요.</del>
            <del th:if="${globalError}" th:text="${globalError}">회원가입 에러</del>
        </footer>
    </article>
</section>

</body>
</html>
