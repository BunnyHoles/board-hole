<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/base :: layout(~{::title}, ~{::main})}">
<head>
    <title th:text="${title ?: '게시판'}">게시판</title>
</head>

<main>
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 text-gradient">게시판</h1>
        <a href="/boards/write" class="btn btn-modern btn-primary">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                <path d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 1h-13z"/>
                <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"/>
            </svg>
            글쓰기
        </a>
    </div>

    <!-- 검색 폼 -->
    <div class="card card-modern mb-4">
        <div class="card-body">
            <form method="get" action="/boards" class="row g-3">
                <div class="col-md-9">
                    <div class="form-floating">
                        <input type="search" class="form-control form-control-modern" 
                               id="search" name="search" th:value="${search}" placeholder="검색어를 입력하세요">
                        <label for="search">제목 또는 내용으로 검색</label>
                    </div>
                </div>
                <div class="col-md-3">
                    <button type="submit" class="btn btn-modern btn-outline-primary w-100 h-100">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                        검색
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- 게시글 목록 -->
    <div class="card card-modern">
        <div class="card-body p-0">
            <div th:if="${boards.content.empty}" class="text-center p-5">
                <svg width="64" height="64" fill="currentColor" viewBox="0 0 16 16" class="text-muted mb-3">
                    <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"/>
                </svg>
                <p class="text-muted">등록된 게시글이 없습니다.</p>
                <a href="/boards/write" class="btn btn-modern btn-primary">첫 번째 글 작성하기</a>
            </div>
            
            <div th:unless="${boards.content.empty}">
                <!-- 반응형 테이블 -->
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th scope="col" class="ps-4">제목</th>
                                <th scope="col" class="text-center d-none d-md-table-cell">작성자</th>
                                <th scope="col" class="text-center d-none d-lg-table-cell">작성일</th>
                                <th scope="col" class="text-center d-none d-lg-table-cell">조회수</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="board : ${boards.content}" class="border-bottom">
                                <td class="ps-4 py-3">
                                    <div class="d-flex flex-column">
                                        <a th:href="@{/boards/{id}(id=${board.id})}" 
                                           class="text-decoration-none fw-semibold text-dark board-title"
                                           th:text="${board.title}">게시글 제목</a>
                                        <div class="d-md-none">
                                            <small class="text-muted">
                                                <span th:text="${board.authorName}">작성자</span> · 
                                                <span th:text="${#temporals.format(board.createdAt, 'yyyy-MM-dd HH:mm')}">작성일</span> · 
                                                조회 <span th:text="${board.viewCount}">0</span>
                                            </small>
                                        </div>
                                    </div>
                                </td>
                                <td class="text-center py-3 d-none d-md-table-cell">
                                    <span class="badge bg-light text-dark" th:text="${board.authorName}">작성자</span>
                                </td>
                                <td class="text-center py-3 d-none d-lg-table-cell">
                                    <small class="text-muted" 
                                           th:text="${#temporals.format(board.createdAt, 'yyyy-MM-dd HH:mm')}">
                                        작성일
                                    </small>
                                </td>
                                <td class="text-center py-3 d-none d-lg-table-cell">
                                    <span class="badge bg-secondary" th:text="${board.viewCount}">0</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 페이지네이션 -->
                <div class="card-footer bg-transparent border-0 py-4" th:if="${boards.totalPages > 1}">
                    <nav aria-label="게시글 페이지네이션">
                        <ul class="pagination justify-content-center mb-0">
                            <!-- 이전 페이지 -->
                            <li class="page-item" th:classappend="${boards.first} ? 'disabled'">
                                <a class="page-link" 
                                   th:href="@{/boards(page=${boards.number - 1}, search=${search})}"
                                   th:if="${!boards.first}">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                                    </svg>
                                </a>
                                <span class="page-link" th:if="${boards.first}">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                                    </svg>
                                </span>
                            </li>

                            <!-- 페이지 번호 -->
                            <th:block th:each="pageNum : ${#numbers.sequence(0, boards.totalPages - 1)}">
                                <li class="page-item" 
                                    th:if="${pageNum >= boards.number - 2 and pageNum <= boards.number + 2}"
                                    th:classappend="${pageNum == boards.number} ? 'active'">
                                    <a class="page-link" 
                                       th:href="@{/boards(page=${pageNum}, search=${search})}"
                                       th:text="${pageNum + 1}">1</a>
                                </li>
                            </th:block>

                            <!-- 다음 페이지 -->
                            <li class="page-item" th:classappend="${boards.last} ? 'disabled'">
                                <a class="page-link" 
                                   th:href="@{/boards(page=${boards.number + 1}, search=${search})}"
                                   th:if="${!boards.last}">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                                    </svg>
                                </a>
                                <span class="page-link" th:if="${boards.last}">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                                    </svg>
                                </span>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- 총 게시글 수 표시 -->
    <div class="mt-3 text-muted text-center" th:unless="${boards.content.empty}">
        <small>
            총 <strong th:text="${boards.totalElements}">0</strong>개의 게시글 중 
            <strong th:text="${boards.number * boards.size + 1}">1</strong>-<strong th:text="${boards.number * boards.size + boards.numberOfElements}">10</strong>개
        </small>
    </div>
</main>
</html>